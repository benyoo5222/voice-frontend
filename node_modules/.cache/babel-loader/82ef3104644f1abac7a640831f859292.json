{"ast":null,"code":"var _jsxFileName = \"/Users/benyoo/Desktop/voice-project/voice-frontend/src/App.js\";\nimport React from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport { BrowserRouter as Router, Switch, Route, Link, useRouteMatch, useParams } from \"react-router-dom\";\nimport useUserInfoAuth from './hooks/useUserInfoAuth';\nimport useHomeTimeLineTweets from './hooks/useHomeTimeLineTweets';\nimport useUserTrending from './hooks/useUserTrending';\nimport Navigation from './components/Navigation/Navigation';\nimport Footer from './components/Footer/Footer';\nimport HomeTimeLine from './components/Home/Home';\nimport SideMenu from './components/SideMenu/SideMenu';\nimport TweetModal from './components/TweetModal/TweetModal';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport './App.scss';\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst context = new AudioContext();\nconst websocket = new WebSocket('ws://localhost:8000'); //put url\n\nwebsocket.binaryType = \"arraybuffer\";\n\nconst downsampleBuffer = function (buffer, sampleRate, outSampleRate) {\n  if (outSampleRate == sampleRate) {\n    return buffer;\n  }\n\n  if (outSampleRate > sampleRate) {\n    throw \"downsampling rate show be smaller than original sample rate\";\n  }\n\n  var sampleRateRatio = sampleRate / outSampleRate;\n  var newLength = Math.round(buffer.length / sampleRateRatio);\n  var result = new Int16Array(newLength);\n  var offsetResult = 0;\n  var offsetBuffer = 0;\n\n  while (offsetResult < result.length) {\n    var nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n    var accum = 0,\n        count = 0;\n\n    for (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n      accum += buffer[i];\n      count++;\n    }\n\n    result[offsetResult] = Math.min(1, accum / count) * 0x7FFF;\n    offsetResult++;\n    offsetBuffer = nextOffsetBuffer;\n  }\n\n  return result;\n};\n\nconst handleListen = () => {\n  navigator.mediaDevices.getUserMedia({\n    audio: true\n  }).then(stream => {\n    console.log(\"STREAm!!!\", stream);\n    let processor = context.createScriptProcessor(2048, 1, 1);\n    processor.connect(context.destination);\n    context.resume();\n    let input = context.createMediaStreamSource(stream);\n    input.connect(processor);\n\n    processor.onaudioprocess = function (e) {\n      var left = e.inputBuffer.getChannelData(0); // var left16 = convertFloat32ToInt16(left); // old 32 to 16 function\n\n      var left16 = downsampleBuffer(left, 44100, 16000);\n      console.log(\"Buffer\", left16);\n      websocket.send(JSON.stringify({\n        connectionID: 3333,\n        audio: Array.from(left16)\n      }));\n    };\n\n    websocket.onopen = () => {\n      console.log(\"Connected\");\n    };\n\n    websocket.onerror = () => {\n      console.log(\"Error!!!!!!!!!\");\n    };\n\n    websocket.onmessage = message => {\n      console.log(\"MESSAGE\", message);\n    };\n  }).catch(err => {\n    console.log(\"error\", err);\n  });\n};\n\nfunction App() {\n  const {\n    isAuthenticated,\n    setAuthenticationStatus,\n    user,\n    setUser\n  } = useUserInfoAuth();\n  const {\n    homeTimeLineTweets,\n    setHomeTimeLineTweets\n  } = useHomeTimeLineTweets(isAuthenticated);\n  const {\n    userTrendingData\n  } = useUserTrending(); //handleListen();\n\n  return /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    xs: 1,\n    sm: 1,\n    md: 3,\n    lg: 3,\n    xl: 3,\n    className: \"removeMargin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 0,\n    sm: 0,\n    md: 2,\n    lg: 1,\n    xl: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Footer, {\n    userInfo: user,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    xs: true,\n    sm: true,\n    md: 9,\n    lg: 7,\n    xl: 6,\n    className: \"main-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Navigation, {\n    userInfo: user,\n    isAuthenticated: isAuthenticated,\n    Switch: Switch,\n    Route: Route,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(HomeTimeLine, {\n    homeTimeLineTweets: homeTimeLineTweets,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    xs: 0,\n    sm: 0,\n    md: 1,\n    lg: 4,\n    xl: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SideMenu, {\n    userTrendingData: userTrendingData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(TweetModal, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/benyoo/Desktop/voice-project/voice-frontend/src/App.js"],"names":["React","BrowserRouter","Router","Switch","Route","Link","useRouteMatch","useParams","useUserInfoAuth","useHomeTimeLineTweets","useUserTrending","Navigation","Footer","HomeTimeLine","SideMenu","TweetModal","Container","Row","Col","AudioContext","window","webkitAudioContext","context","websocket","WebSocket","binaryType","downsampleBuffer","buffer","sampleRate","outSampleRate","sampleRateRatio","newLength","Math","round","length","result","Int16Array","offsetResult","offsetBuffer","nextOffsetBuffer","accum","count","i","min","handleListen","navigator","mediaDevices","getUserMedia","audio","then","stream","console","log","processor","createScriptProcessor","connect","destination","resume","input","createMediaStreamSource","onaudioprocess","e","left","inputBuffer","getChannelData","left16","send","JSON","stringify","connectionID","Array","from","onopen","onerror","onmessage","message","catch","err","App","isAuthenticated","setAuthenticationStatus","user","setUser","homeTimeLineTweets","setHomeTimeLineTweets","userTrendingData"],"mappings":"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","sourcesContent":["import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  useRouteMatch,\n  useParams,\n} from \"react-router-dom\";\nimport useUserInfoAuth from './hooks/useUserInfoAuth';\nimport useHomeTimeLineTweets from './hooks/useHomeTimeLineTweets';\nimport useUserTrending from './hooks/useUserTrending';\nimport Navigation from './components/Navigation/Navigation';\nimport Footer from './components/Footer/Footer';\nimport HomeTimeLine from './components/Home/Home';\nimport SideMenu from './components/SideMenu/SideMenu';\nimport TweetModal from './components/TweetModal/TweetModal';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport './App.scss';\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst context = new AudioContext();\n\nconst websocket = new WebSocket('ws://localhost:8000'); //put url\nwebsocket.binaryType = \"arraybuffer\";\n\nconst downsampleBuffer = function (buffer, sampleRate, outSampleRate) {\n\tif (outSampleRate == sampleRate) {\n\t\treturn buffer;\n\t}\n\tif (outSampleRate > sampleRate) {\n\t\tthrow \"downsampling rate show be smaller than original sample rate\";\n\t}\n\tvar sampleRateRatio = sampleRate / outSampleRate;\n\tvar newLength = Math.round(buffer.length / sampleRateRatio);\n\tvar result = new Int16Array(newLength);\n\tvar offsetResult = 0;\n\tvar offsetBuffer = 0;\n\twhile (offsetResult < result.length) {\n\t\tvar nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n\t\tvar accum = 0, count = 0;\n\t\tfor (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n\t\t\taccum += buffer[i];\n\t\t\tcount++;\n\t\t}\n\n\t\tresult[offsetResult] = Math.min(1, accum / count) * 0x7FFF;\n\t\toffsetResult++;\n\t\toffsetBuffer = nextOffsetBuffer;\n  }\n  return result;\n};\n\nconst handleListen = () => {\n  navigator.mediaDevices.getUserMedia({\n    audio: true,\n  }).then((stream) => {\n    console.log(\"STREAm!!!\", stream)\n\n    let processor = context.createScriptProcessor(2048, 1, 1);\n    processor.connect(context.destination);\n    context.resume();\n\n    let input = context.createMediaStreamSource(stream);\n\t\tinput.connect(processor);\n\n\t\tprocessor.onaudioprocess = function (e) {\n\t\t\tvar left = e.inputBuffer.getChannelData(0);\n      // var left16 = convertFloat32ToInt16(left); // old 32 to 16 function\n      var left16 = downsampleBuffer(left, 44100, 16000);\n      console.log(\"Buffer\", left16);\n\n      websocket.send(JSON.stringify({connectionID: 3333, audio: Array.from(left16)}));\n    };\n    \n    websocket.onopen = () => {\n      console.log(\"Connected\");\n    };\n\n    websocket.onerror = () => {\n      console.log(\"Error!!!!!!!!!\")\n    }\n    \n    websocket.onmessage = (message) => {\n      console.log(\"MESSAGE\", message);\n    };\n  })\n  .catch((err) => {\n    console.log(\"error\", err);\n  })\n};\n\nfunction App() {\n  const {\n    isAuthenticated,\n    setAuthenticationStatus,\n    user,\n    setUser,\n  } = useUserInfoAuth();\n\n  const {\n    homeTimeLineTweets,\n    setHomeTimeLineTweets,\n  } = useHomeTimeLineTweets(isAuthenticated);\n\n  const {\n    userTrendingData\n  } = useUserTrending();\n\n  //handleListen();\n  return (\n    <Router>\n      <Container fluid className=\"container\">\n        <Row xs={1} sm={1} md={3} lg={3} xl={3} className=\"removeMargin\">\n          <Col xs={0} sm={0} md={2} lg={1} xl={3}>\n            <Footer userInfo={user} />\n          </Col>\n\n          <Col xs sm md={9} lg={7} xl={6} className=\"main-content\">\n            <Switch>\n              <Navigation \n                userInfo={user} \n                isAuthenticated={isAuthenticated}\n                Switch={Switch}\n                Route={Route}\n              />\n              <HomeTimeLine homeTimeLineTweets={homeTimeLineTweets} />\n              {/* <Route path=\"/\">\n                <HomeTimeLine homeTimeLineTweets={homeTimeLineTweets} />\n              </Route> */}\n            </Switch>\n          </Col>\n\n          <Col xs={0} sm={0} md={1} lg={4} xl={3}>\n            <SideMenu userTrendingData={userTrendingData} />\n          </Col>\n        </Row>\n\n        <TweetModal />\n      </Container>\n  </Router>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}