{"ast":null,"code":"var _jsxFileName = \"/Users/benyoo/Desktop/voice-frontend/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport axios from 'axios';\nimport crypto from 'crypto';\nimport v4 from './lib/aws-signature-v4';\nimport audioUtils from './lib/audioUtils';\nimport mic from 'microphone-stream';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button'; // import marshaller from '@aws-sdk/eventstream-marshaller';\n// import util_utf8_node from '@aws-sdk/util-utf8-node';\n\nconst marshaller = require(\"@aws-sdk/eventstream-marshaller\"); // for converting binary event stream messages to and from JSON\n\n\nconst util_utf8_node = require(\"@aws-sdk/util-utf8-node\");\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst context = new AudioContext();\nconst tweetsInfo = [{\n  created_at: 'Mon Nov 02 01:41:00 +0000 2020',\n  id: 1323077617386356700,\n  id_str: '1323077617386356736',\n  text: \"Stunning images of our galaxy from travel photography blog 'Capture the Atlas' https://t.co/a4gE4vqzJP https://t.co/O6CvTGFMzG\",\n  truncated: false,\n  entities: {\n    hashtags: [],\n    symbols: [],\n    user_mentions: [],\n    urls: [Array],\n    media: [Array]\n  },\n  extended_entities: {\n    media: [Array]\n  },\n  source: '<a href=\"https://studio.twitter.com\" rel=\"nofollow\">Twitter Media Studio</a>',\n  in_reply_to_status_id: null,\n  in_reply_to_status_id_str: null,\n  in_reply_to_user_id: null,\n  in_reply_to_user_id_str: null,\n  in_reply_to_screen_name: null,\n  user: {\n    id: 91478624,\n    id_str: '91478624',\n    name: 'Forbes',\n    screen_name: 'Forbes',\n    location: 'New York, NY',\n    description: 'Official Twitter account of Forbes, the worldâ€™s leading voice for entrepreneurial success and free enterprise.',\n    url: 'http://t.co/KH6EtekF5q',\n    entities: [Object],\n    protected: false,\n    followers_count: 16347202,\n    friends_count: 5236,\n    listed_count: 57596,\n    created_at: 'Sat Nov 21 02:09:57 +0000 2009',\n    favourites_count: 10309,\n    utc_offset: null,\n    time_zone: null,\n    geo_enabled: true,\n    verified: true,\n    statuses_count: 257000,\n    lang: null,\n    contributors_enabled: false,\n    is_translator: false,\n    is_translation_enabled: true,\n    profile_background_color: '072250',\n    profile_background_image_url: 'http://abs.twimg.com/images/themes/theme1/bg.png',\n    profile_background_image_url_https: 'https://abs.twimg.com/images/themes/theme1/bg.png',\n    profile_background_tile: false,\n    profile_image_url: 'http://pbs.twimg.com/profile_images/1106672424605630465/IC9ipKIt_normal.png',\n    profile_image_url_https: 'https://pbs.twimg.com/profile_images/1106672424605630465/IC9ipKIt_normal.png',\n    profile_banner_url: 'https://pbs.twimg.com/profile_banners/91478624/1585748525',\n    profile_link_color: '072250',\n    profile_sidebar_border_color: 'CCCCCC',\n    profile_sidebar_fill_color: 'F7F7F7',\n    profile_text_color: '000000',\n    profile_use_background_image: true,\n    has_extended_profile: false,\n    default_profile: false,\n    default_profile_image: false,\n    following: true,\n    follow_request_sent: false,\n    notifications: false,\n    translator_type: 'regular'\n  },\n  geo: null,\n  coordinates: null,\n  place: null,\n  contributors: null,\n  is_quote_status: false,\n  retweet_count: 9,\n  favorite_count: 25,\n  favorited: false,\n  retweeted: false,\n  possibly_sensitive: false,\n  possibly_sensitive_appealable: false,\n  lang: 'en'\n}, {\n  created_at: 'Mon Nov 02 01:40:40 +0000 2020',\n  id: 1323077535635263500,\n  id_str: '1323077535635263488',\n  text: 'If you donâ€™t know, now you know.\\n' + '\\n' + '#DALvsPHI | #FlyEaglesFly\\n' + '\\n' + 'ðŸ“º: NBC https://t.co/me5VsKOhj7',\n  truncated: false,\n  entities: {\n    hashtags: [Array],\n    symbols: [],\n    user_mentions: [],\n    urls: [],\n    media: [Array]\n  },\n  extended_entities: {\n    media: [Array]\n  },\n  source: '<a href=\"https://studio.twitter.com\" rel=\"nofollow\">Twitter Media Studio</a>',\n  in_reply_to_status_id: null,\n  in_reply_to_status_id_str: null,\n  in_reply_to_user_id: null,\n  in_reply_to_user_id_str: null,\n  in_reply_to_screen_name: null,\n  user: {\n    id: 180503626,\n    id_str: '180503626',\n    name: 'Philadelphia Eagles',\n    screen_name: 'Eagles',\n    location: 'Philadelphia, PA',\n    description: '',\n    url: 'https://t.co/XLqr1xYvDZ',\n    entities: [Object],\n    protected: false,\n    followers_count: 3484531,\n    friends_count: 118,\n    listed_count: 8182,\n    created_at: 'Thu Aug 19 20:04:15 +0000 2010',\n    favourites_count: 5315,\n    utc_offset: null,\n    time_zone: null,\n    geo_enabled: true,\n    verified: true,\n    statuses_count: 55260,\n    lang: null,\n    contributors_enabled: false,\n    is_translator: false,\n    is_translation_enabled: false,\n    profile_background_color: 'FFFFFF',\n    profile_background_image_url: 'http://abs.twimg.com/images/themes/theme14/bg.gif',\n    profile_background_image_url_https: 'https://abs.twimg.com/images/themes/theme14/bg.gif',\n    profile_background_tile: false,\n    profile_image_url: 'http://pbs.twimg.com/profile_images/1322221752219537408/XDRAw888_normal.jpg',\n    profile_image_url_https: 'https://pbs.twimg.com/profile_images/1322221752219537408/XDRAw888_normal.jpg',\n    profile_banner_url: 'https://pbs.twimg.com/profile_banners/180503626/1603918055',\n    profile_link_color: '004953',\n    profile_sidebar_border_color: '000000',\n    profile_sidebar_fill_color: 'EFEFEF',\n    profile_text_color: '333333',\n    profile_use_background_image: false,\n    has_extended_profile: true,\n    default_profile: false,\n    default_profile_image: false,\n    following: true,\n    follow_request_sent: false,\n    notifications: false,\n    translator_type: 'regular'\n  },\n  geo: null,\n  coordinates: null,\n  place: null,\n  contributors: null,\n  is_quote_status: false,\n  retweet_count: 90,\n  favorite_count: 469,\n  favorited: false,\n  retweeted: false,\n  possibly_sensitive: false,\n  possibly_sensitive_appealable: false,\n  lang: 'en'\n}];\nlet inputSampleRate;\nconst eventStreamMarshaller = new marshaller.EventStreamMarshaller(util_utf8_node.toUtf8, util_utf8_node.fromUtf8);\nconst websocket = new WebSocket('ws://localhost:8000'); //put url\n\nwebsocket.binaryType = \"arraybuffer\";\n\nwebsocket.onopen = () => {\n  console.log(\"Connected\");\n};\n\nwebsocket.onerror = () => {\n  console.log(\"Error!!!!!!!!!\");\n};\n\nwebsocket.onmessage = message => {\n  console.log(\"MESSAGE\", message);\n};\n\nconst getAudioEventMessage = buffer => {\n  // wrap the audio data in a JSON envelope\n  return {\n    headers: {\n      ':message-type': {\n        type: 'string',\n        value: 'event'\n      },\n      ':event-type': {\n        type: 'string',\n        value: 'AudioEvent'\n      }\n    },\n    body: buffer\n  };\n};\n\nconst downsampleBuffer = function (buffer, sampleRate, outSampleRate) {\n  if (outSampleRate == sampleRate) {\n    return buffer;\n  }\n\n  if (outSampleRate > sampleRate) {\n    throw \"downsampling rate show be smaller than original sample rate\";\n  }\n\n  var sampleRateRatio = sampleRate / outSampleRate;\n  var newLength = Math.round(buffer.length / sampleRateRatio);\n  var result = new Int16Array(newLength);\n  var offsetResult = 0;\n  var offsetBuffer = 0;\n\n  while (offsetResult < result.length) {\n    var nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n    var accum = 0,\n        count = 0;\n\n    for (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n      accum += buffer[i];\n      count++;\n    }\n\n    result[offsetResult] = Math.min(1, accum / count) * 0x7FFF;\n    offsetResult++;\n    offsetBuffer = nextOffsetBuffer;\n  }\n\n  return result;\n};\n\nconst handleListen = () => {\n  navigator.mediaDevices.getUserMedia({\n    audio: true\n  }).then(stream => {\n    console.log(\"STREAm!!!\", stream);\n    let processor = context.createScriptProcessor(2048, 1, 1);\n    processor.connect(context.destination);\n    context.resume();\n    let input = context.createMediaStreamSource(stream);\n    input.connect(processor);\n\n    processor.onaudioprocess = function (e) {\n      var left = e.inputBuffer.getChannelData(0); // var left16 = convertFloat32ToInt16(left); // old 32 to 16 function\n\n      var left16 = downsampleBuffer(left, 44100, 16000);\n      console.log(\"Buffer\", left16);\n      websocket.send(JSON.stringify({\n        connectionID: 3333,\n        audio: Array.from(left16)\n      }));\n    };\n\n    websocket.onerror = () => {\n      console.log(\"Error!!!!!!!!!\");\n    };\n\n    websocket.onmessage = message => {\n      console.log(\"MESSAGE\", message);\n    };\n  }).catch(err => {\n    console.log(\"error\", err);\n  });\n};\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1)\n    }\n  }\n}));\n\nconst handleLogin = () => {\n  window.open(\"http://localhost:4000/auth/twitter\", \"_self\");\n};\n\nfunction App() {\n  const [isAuthenticated, setAuthenticationStatus] = useState(false);\n  const [user, setUser] = useState({});\n  useEffect(() => {\n    console.log(\"Triggered\");\n    axios({\n      url: \"http://localhost:4000/\",\n      method: \"GET\",\n      withCredentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    }).then(response => {\n      if (response.status === 200) {\n        console.log(\"response\", response);\n        return response;\n      }\n\n      throw new Error(\"failed to authenticate user\");\n    }).then(responseJson => {\n      // this.setState({\n      //   authenticated: true,\n      //   user: responseJson.user\n      // });\n      console.log(\"response JSON\", responseJson);\n      setAuthenticationStatus(true);\n      setUser({\n        user: responseJson.data.user\n      });\n    }).catch(error => {\n      console.log(\"Error getting user\", error);\n      setAuthenticationStatus(false);\n    });\n    console.log(\"Checking auth status\", isAuthenticated);\n  }, []);\n  useEffect(() => {\n    console.log(\"change in auth status\", isAuthenticated);\n\n    if (isAuthenticated) {\n      axios({\n        url: \"http://localhost:4000/home-timeline-tweets\",\n        method: \"GET\",\n        withCredentials: \"include\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Credentials\": true\n        }\n      }).then(res => {\n        console.log(\"tweets\", res);\n      }).catch(err => {\n        console.log(\"error getting tweets\", err);\n      });\n    }\n  }, [isAuthenticated]); //handleListen();\n\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 5\n    }\n  }, isAuthenticated ? /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 11\n    }\n  }, \"Welcome \", user.user ? user.user.name : null, \"!\") : /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 13\n    }\n  }, \"Primary\")), /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: logo,\n    className: \"App-logo\",\n    alt: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 9\n    }\n  }, \"Edit \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 16\n    }\n  }, \"src/App.js\"), \" and save to reload.\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"App-link\",\n    href: \"https://reactjs.org\",\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 9\n    }\n  }, \"Learn React\")));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/benyoo/Desktop/voice-frontend/src/App.js"],"names":["React","useState","useEffect","axios","crypto","v4","audioUtils","mic","makeStyles","Button","marshaller","require","util_utf8_node","AudioContext","window","webkitAudioContext","context","tweetsInfo","created_at","id","id_str","text","truncated","entities","hashtags","symbols","user_mentions","urls","Array","media","extended_entities","source","in_reply_to_status_id","in_reply_to_status_id_str","in_reply_to_user_id","in_reply_to_user_id_str","in_reply_to_screen_name","user","name","screen_name","location","description","url","Object","protected","followers_count","friends_count","listed_count","favourites_count","utc_offset","time_zone","geo_enabled","verified","statuses_count","lang","contributors_enabled","is_translator","is_translation_enabled","profile_background_color","profile_background_image_url","profile_background_image_url_https","profile_background_tile","profile_image_url","profile_image_url_https","profile_banner_url","profile_link_color","profile_sidebar_border_color","profile_sidebar_fill_color","profile_text_color","profile_use_background_image","has_extended_profile","default_profile","default_profile_image","following","follow_request_sent","notifications","translator_type","geo","coordinates","place","contributors","is_quote_status","retweet_count","favorite_count","favorited","retweeted","possibly_sensitive","possibly_sensitive_appealable","inputSampleRate","eventStreamMarshaller","EventStreamMarshaller","toUtf8","fromUtf8","websocket","WebSocket","binaryType","onopen","console","log","onerror","onmessage","message","getAudioEventMessage","buffer","headers","type","value","body","downsampleBuffer","sampleRate","outSampleRate","sampleRateRatio","newLength","Math","round","length","result","Int16Array","offsetResult","offsetBuffer","nextOffsetBuffer","accum","count","i","min","handleListen","navigator","mediaDevices","getUserMedia","audio","then","stream","processor","createScriptProcessor","connect","destination","resume","input","createMediaStreamSource","onaudioprocess","e","left","inputBuffer","getChannelData","left16","send","JSON","stringify","connectionID","from","catch","err","useStyles","theme","root","margin","spacing","handleLogin","open","App","isAuthenticated","setAuthenticationStatus","setUser","method","withCredentials","Accept","response","status","Error","responseJson","data","error","res","classes","logo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport axios from 'axios';\nimport crypto from 'crypto';\nimport v4 from './lib/aws-signature-v4';\nimport audioUtils from './lib/audioUtils';\nimport mic from 'microphone-stream';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\n\n// import marshaller from '@aws-sdk/eventstream-marshaller';\n// import util_utf8_node from '@aws-sdk/util-utf8-node';\n\nconst marshaller = require(\"@aws-sdk/eventstream-marshaller\"); // for converting binary event stream messages to and from JSON\nconst util_utf8_node = require(\"@aws-sdk/util-utf8-node\");\n\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nconst context = new AudioContext();\n\nconst tweetsInfo = [\n  {\n    created_at: 'Mon Nov 02 01:41:00 +0000 2020',\n    id: 1323077617386356700,\n    id_str: '1323077617386356736',\n    text: \"Stunning images of our galaxy from travel photography blog 'Capture the Atlas' https://t.co/a4gE4vqzJP https://t.co/O6CvTGFMzG\",\n    truncated: false,\n    entities: {\n      hashtags: [],\n      symbols: [],\n      user_mentions: [],\n      urls: [Array],\n      media: [Array]\n    },\n    extended_entities: { media: [Array] },\n    source: '<a href=\"https://studio.twitter.com\" rel=\"nofollow\">Twitter Media Studio</a>',\n    in_reply_to_status_id: null,\n    in_reply_to_status_id_str: null,\n    in_reply_to_user_id: null,\n    in_reply_to_user_id_str: null,\n    in_reply_to_screen_name: null,\n    user: {\n      id: 91478624,\n      id_str: '91478624',\n      name: 'Forbes',\n      screen_name: 'Forbes',\n      location: 'New York, NY',\n      description: 'Official Twitter account of Forbes, the worldâ€™s leading voice for entrepreneurial success and free enterprise.',\n      url: 'http://t.co/KH6EtekF5q',\n      entities: [Object],\n      protected: false,\n      followers_count: 16347202,\n      friends_count: 5236,\n      listed_count: 57596,\n      created_at: 'Sat Nov 21 02:09:57 +0000 2009',\n      favourites_count: 10309,\n      utc_offset: null,\n      time_zone: null,\n      geo_enabled: true,\n      verified: true,\n      statuses_count: 257000,\n      lang: null,\n      contributors_enabled: false,\n      is_translator: false,\n      is_translation_enabled: true,\n      profile_background_color: '072250',\n      profile_background_image_url: 'http://abs.twimg.com/images/themes/theme1/bg.png',\n      profile_background_image_url_https: 'https://abs.twimg.com/images/themes/theme1/bg.png',\n      profile_background_tile: false,\n      profile_image_url: 'http://pbs.twimg.com/profile_images/1106672424605630465/IC9ipKIt_normal.png',\n      profile_image_url_https: 'https://pbs.twimg.com/profile_images/1106672424605630465/IC9ipKIt_normal.png',\n      profile_banner_url: 'https://pbs.twimg.com/profile_banners/91478624/1585748525',\n      profile_link_color: '072250',\n      profile_sidebar_border_color: 'CCCCCC',\n      profile_sidebar_fill_color: 'F7F7F7',\n      profile_text_color: '000000',\n      profile_use_background_image: true,\n      has_extended_profile: false,\n      default_profile: false,\n      default_profile_image: false,\n      following: true,\n      follow_request_sent: false,\n      notifications: false,\n      translator_type: 'regular'\n    },\n    geo: null,\n    coordinates: null,\n    place: null,\n    contributors: null,\n    is_quote_status: false,\n    retweet_count: 9,\n    favorite_count: 25,\n    favorited: false,\n    retweeted: false,\n    possibly_sensitive: false,\n    possibly_sensitive_appealable: false,\n    lang: 'en'\n  },\n  {\n    created_at: 'Mon Nov 02 01:40:40 +0000 2020',\n    id: 1323077535635263500,\n    id_str: '1323077535635263488',\n    text: 'If you donâ€™t know, now you know.\\n' +\n      '\\n' +\n      '#DALvsPHI | #FlyEaglesFly\\n' +\n      '\\n' +\n      'ðŸ“º: NBC https://t.co/me5VsKOhj7',\n    truncated: false,\n    entities: {\n      hashtags: [Array],\n      symbols: [],\n      user_mentions: [],\n      urls: [],\n      media: [Array]\n    },\n    extended_entities: { media: [Array] },\n    source: '<a href=\"https://studio.twitter.com\" rel=\"nofollow\">Twitter Media Studio</a>',\n    in_reply_to_status_id: null,\n    in_reply_to_status_id_str: null,\n    in_reply_to_user_id: null,\n    in_reply_to_user_id_str: null,\n    in_reply_to_screen_name: null,\n    user: {\n      id: 180503626,\n      id_str: '180503626',\n      name: 'Philadelphia Eagles',\n      screen_name: 'Eagles',\n      location: 'Philadelphia, PA',\n      description: '',\n      url: 'https://t.co/XLqr1xYvDZ',\n      entities: [Object],\n      protected: false,\n      followers_count: 3484531,\n      friends_count: 118,\n      listed_count: 8182,\n      created_at: 'Thu Aug 19 20:04:15 +0000 2010',\n      favourites_count: 5315,\n      utc_offset: null,\n      time_zone: null,\n      geo_enabled: true,\n      verified: true,\n      statuses_count: 55260,\n      lang: null,\n      contributors_enabled: false,\n      is_translator: false,\n      is_translation_enabled: false,\n      profile_background_color: 'FFFFFF',\n      profile_background_image_url: 'http://abs.twimg.com/images/themes/theme14/bg.gif',\n      profile_background_image_url_https: 'https://abs.twimg.com/images/themes/theme14/bg.gif',\n      profile_background_tile: false,\n      profile_image_url: 'http://pbs.twimg.com/profile_images/1322221752219537408/XDRAw888_normal.jpg',\n      profile_image_url_https: 'https://pbs.twimg.com/profile_images/1322221752219537408/XDRAw888_normal.jpg',\n      profile_banner_url: 'https://pbs.twimg.com/profile_banners/180503626/1603918055',\n      profile_link_color: '004953',\n      profile_sidebar_border_color: '000000',\n      profile_sidebar_fill_color: 'EFEFEF',\n      profile_text_color: '333333',\n      profile_use_background_image: false,\n      has_extended_profile: true,\n      default_profile: false,\n      default_profile_image: false,\n      following: true,\n      follow_request_sent: false,\n      notifications: false,\n      translator_type: 'regular'\n    },\n    geo: null,\n    coordinates: null,\n    place: null,\n    contributors: null,\n    is_quote_status: false,\n    retweet_count: 90,\n    favorite_count: 469,\n    favorited: false,\n    retweeted: false,\n    possibly_sensitive: false,\n    possibly_sensitive_appealable: false,\n    lang: 'en'\n  }\n];\n\nlet inputSampleRate;\n\nconst eventStreamMarshaller = new marshaller.EventStreamMarshaller(util_utf8_node.toUtf8, util_utf8_node.fromUtf8);\n\nconst websocket = new WebSocket('ws://localhost:8000'); //put url\nwebsocket.binaryType = \"arraybuffer\";\n\nwebsocket.onopen = () => {\n  console.log(\"Connected\");\n};\n\nwebsocket.onerror = () => {\n  console.log(\"Error!!!!!!!!!\")\n}\n\nwebsocket.onmessage = (message) => {\n  console.log(\"MESSAGE\", message);\n};\n\nconst getAudioEventMessage = (buffer) => {\n  // wrap the audio data in a JSON envelope\n  return {\n      headers: {\n          ':message-type': {\n              type: 'string',\n              value: 'event'\n          },\n          ':event-type': {\n              type: 'string',\n              value: 'AudioEvent'\n          }\n      },\n      body: buffer\n  };\n};\n\nconst downsampleBuffer = function (buffer, sampleRate, outSampleRate) {\n\tif (outSampleRate == sampleRate) {\n\t\treturn buffer;\n\t}\n\tif (outSampleRate > sampleRate) {\n\t\tthrow \"downsampling rate show be smaller than original sample rate\";\n\t}\n\tvar sampleRateRatio = sampleRate / outSampleRate;\n\tvar newLength = Math.round(buffer.length / sampleRateRatio);\n\tvar result = new Int16Array(newLength);\n\tvar offsetResult = 0;\n\tvar offsetBuffer = 0;\n\twhile (offsetResult < result.length) {\n\t\tvar nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n\t\tvar accum = 0, count = 0;\n\t\tfor (var i = offsetBuffer; i < nextOffsetBuffer && i < buffer.length; i++) {\n\t\t\taccum += buffer[i];\n\t\t\tcount++;\n\t\t}\n\n\t\tresult[offsetResult] = Math.min(1, accum / count) * 0x7FFF;\n\t\toffsetResult++;\n\t\toffsetBuffer = nextOffsetBuffer;\n  }\n  return result;\n};\n\nconst handleListen = () => {\n  navigator.mediaDevices.getUserMedia({\n    audio: true,\n  }).then((stream) => {\n    console.log(\"STREAm!!!\", stream)\n\n    let processor = context.createScriptProcessor(2048, 1, 1);\n    processor.connect(context.destination);\n    context.resume();\n\n    let input = context.createMediaStreamSource(stream);\n\t\tinput.connect(processor);\n\n\t\tprocessor.onaudioprocess = function (e) {\n\t\t\tvar left = e.inputBuffer.getChannelData(0);\n      // var left16 = convertFloat32ToInt16(left); // old 32 to 16 function\n      var left16 = downsampleBuffer(left, 44100, 16000);\n      console.log(\"Buffer\", left16);\n\n      websocket.send(JSON.stringify({connectionID: 3333, audio: Array.from(left16)}));\n    };\n    \n    websocket.onerror = () => {\n      console.log(\"Error!!!!!!!!!\")\n    }\n    \n    websocket.onmessage = (message) => {\n      console.log(\"MESSAGE\", message);\n    };\n  })\n  .catch((err) => {\n    console.log(\"error\", err);\n  })\n};\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1),\n    },\n  },\n}));\n\nconst handleLogin = () => {\n  window.open(\"http://localhost:4000/auth/twitter\", \"_self\");\n};\n\nfunction App() {\n  const [isAuthenticated, setAuthenticationStatus] = useState(false);\n  const [user, setUser] = useState({});\n\n  useEffect(() => {\n    console.log(\"Triggered\");\n\n    axios({\n      url: \"http://localhost:4000/\",\n      method: \"GET\",\n      withCredentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Credentials\": true\n      }\n    })\n      .then(response => {\n        if (response.status === 200) {\n          console.log(\"response\", response);\n          return response;\n        }\n        throw new Error(\"failed to authenticate user\");\n      })\n      .then(responseJson => {\n        // this.setState({\n        //   authenticated: true,\n        //   user: responseJson.user\n        // });\n\n        console.log(\"response JSON\", responseJson);\n\n        setAuthenticationStatus(true);\n        setUser({user: responseJson.data.user});\n      })\n      .catch(error => {\n        console.log(\"Error getting user\", error);\n        setAuthenticationStatus(false);\n      });\n    \n      console.log(\"Checking auth status\", isAuthenticated);\n  }, []);\n\n  useEffect(() => {\n    console.log(\"change in auth status\", isAuthenticated);\n\n    if (isAuthenticated) {\n      axios({\n        url: \"http://localhost:4000/home-timeline-tweets\",\n        method: \"GET\",\n        withCredentials: \"include\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Credentials\": true\n        }\n      })\n      .then(res => {\n        console.log(\"tweets\", res);\n      })\n      .catch(err => {\n        console.log(\"error getting tweets\", err);\n      });\n    }\n  }, [isAuthenticated]);\n\n  //handleListen();\n  const classes = useStyles();\n  return (\n    <div className=\"App\">\n      {isAuthenticated \n        ? <h2>Welcome {user.user ? user.user.name : null}!</h2>\n        : <div className={classes.root}>\n            <Button color=\"primary\" onClick={handleLogin}>Primary</Button>\n          </div> \n      }\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.js</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}